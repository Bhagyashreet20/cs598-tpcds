With the TPC-DS dataset as a reference, using the table and field names from the TPC-DS benchmark, convert natural language directive provided as input into an SQL query in the Netezza dialect?
Input: For each combination of item description, warehouse name, and week sequence, this query counts the number of sales transactions with and without promotions. It filters the data based on various conditions, including the week sequence matching between different date dimensions, inventory quantity on hand being less than the catalog sales quantity, the ship date being more than 5 days after the sold date in 2002, household demographics indicating a buy potential of '501-1000', marital status being 'W', and the year being 2002. The results are grouped by item description, warehouse name, and week sequence and then ordered by the total count of sales transactions in descending order, followed by item description, warehouse name, and week sequence. The query returns a maximum of 100 rows.