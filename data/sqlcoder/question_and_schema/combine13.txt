Calculate the average sales quantity, average sales price, average wholesale cost, and the total wholesale cost for store sales, where the sales took place in the year 2001. This calculation is based on various customer types, including those distinguished by marital status and education status, and their associated household demographics. Specifically, it considers customers with marital status 'D' and education status 'Unknown' who made purchases with sales prices between $100.00 and $150.00 and had a household dependency count of 3. It also includes customers with marital status 'S' and education status 'College' who made purchases with sales prices between $50.00 and $100.00 and had a household dependency count of 1, as well as customers with marital status 'M' and education status '4 yr Degree' who made purchases with sales prices between $150.00 and $200.00 and had a household dependency count of 1. Additionally, this calculation takes into account different combinations of states ('SD', 'KS', 'MI' and 'MO', 'ND', 'CO' and 'NH', 'OH', 'TX') and their corresponding sales profits and is restricted to transactions in the 'United States'. The result provides insights into the sales performance for these specific customer segments in the mentioned year.

CREATE TABLE store_sales (  ss_sold_date_sk,  ss_sold_time_sk,  ss_item_sk,  ss_customer_sk,  ss_cdemo_sk,  ss_hdemo_sk,  ss_addr_sk,  ss_store_sk,  ss_promo_sk,  ss_ticket_number,  ss_quantity,  ss_wholesale_cost,  ss_list_price,  ss_sales_price,  ss_ext_discount_amt,  ss_ext_sales_price,  ss_ext_wholesale_cost,  ss_ext_list_price,  ss_ext_tax,  ss_coupon_amt,  ss_net_paid,  ss_net_paid_inc_tax,  ss_net_profit );

CREATE TABLE customer_demographics (  cd_demo_sk,  cd_gender,  cd_marital_status,  cd_education_status,  cd_purchase_estimate,  cd_credit_rating,  cd_dep_count,  cd_dep_employed_count,  cd_dep_college_count );

CREATE TABLE household_demographics (  hd_demo_sk,  hd_income_band_sk,  hd_buy_potential,  hd_dep_count,  hd_vehicle_count );

CREATE TABLE customer_address (  ca_address_sk,  ca_address_id,  ca_street_number,  ca_street_name,  ca_street_type,  ca_suite_number,  ca_city,  ca_county,  ca_state,  ca_zip,  ca_country,  ca_gmt_offset,  ca_location_type );

CREATE TABLE date_dim (  d_date_sk,  d_date_id,  d_date,  d_month_seq,  d_week_seq,  d_quarter_seq,  d_year,  d_dow,  d_moy,  d_dom,  d_qoy,  d_fy_year,  d_fy_quarter_seq,  d_fy_week_seq,  d_day_name,  d_quarter_name,  d_holiday,  d_weekend,  d_following_holiday,  d_first_dom,  d_last_dom,  d_same_day_ly,  d_same_day_lq,  d_current_day,  d_current_week,  d_current_month,  d_current_quarter,  d_current_year );