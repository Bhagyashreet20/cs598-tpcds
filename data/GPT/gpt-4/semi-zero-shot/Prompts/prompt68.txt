With the TPC-DS dataset as a reference, using the table and field names from the TPC-DS benchmark, convert natural language directive provided as input into an SQL query in the Netezza dialect?
Input: Calculate the per customer extended sales price, extended list price, and extended tax for shoppers who are not from the same city as the store they bought from. This applies to stores located in both Pleasant Hill and Five Points, and the purchases occurred in the first two days of each month for three consecutive years (1998, 1999, and 2000). We are only considering customers with 8 dependents or no vehicles. The results are ordered by the customer's last name and ticket number, and the query returns the top 100 records.