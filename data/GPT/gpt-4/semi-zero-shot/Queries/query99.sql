SELECT 
    W.WAREHOUSE_NAME,
    SM.SHIP_MODE,
    CC.CALL_CENTER_NAME,
    COUNT(CASE WHEN DATEDIFF(DAY, CS.ORDER_DATE, CS.SHIP_DATE) BETWEEN 0 AND 30 THEN 1 END) AS "0-30 DAYS",
    COUNT(CASE WHEN DATEDIFF(DAY, CS.ORDER_DATE, CS.SHIP_DATE) BETWEEN 31 AND 60 THEN 1 END) AS "31-60 DAYS",
    COUNT(CASE WHEN DATEDIFF(DAY, CS.ORDER_DATE, CS.SHIP_DATE) BETWEEN 61 AND 90 THEN 1 END) AS "61-90 DAYS",
    COUNT(CASE WHEN DATEDIFF(DAY, CS.ORDER_DATE, CS.SHIP_DATE) BETWEEN 91 AND 120 THEN 1 END) AS "91-120 DAYS",
    COUNT(CASE WHEN DATEDIFF(DAY, CS.ORDER_DATE, CS.SHIP_DATE) > 120 THEN 1 END) AS "OVER 120 DAYS"
FROM 
    CATALOG_SALES CS
JOIN DATE_DIM D ON CS.CS_SOLD_DATE_SK = D.D_DATE_SK
JOIN WAREHOUSE W ON CS.CS_WAREHOUSE_SK = W.WAREHOUSE_SK
JOIN SHIP_MODE SM ON CS.CS_SHIP_MODE_SK = SM.SHIP_MODE_SK
JOIN CALL_CENTER CC ON CS.CS_CALL_CENTER_SK = CC.CALL_CENTER_SK
WHERE 
    D.D_YEAR = 1224
GROUP BY 
    W.WAREHOUSE_NAME,
    SM.SHIP_MODE,
    CC.CALL_CENTER_NAME
ORDER BY 
    SUBSTR(W.WAREHOUSE_NAME, 1, 20) ASC,
    SM.SHIP_MODE ASC,
    CC.CALL_CENTER_NAME ASC
LIMIT 100;
