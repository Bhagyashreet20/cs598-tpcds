With the TPC-DS dataset as a reference, using the table and field names from the TPC-DS benchmark, convert natural language directive provided as input into an SQL query in the Netezza dialect?
Input: For each product name, brand, class, and category, this query calculates the average quantity on hand for products within the date range corresponding to the 12 months starting from month 1188. It then rolls up the data, providing aggregated results at different levels of granularity, including product name, brand, class, and category. Finally, the results are sorted in ascending order based on the calculated average quantity on hand (qoh), with secondary sorting applied to the product name, brand, class, and category. The query returns a maximum of 100 rows.