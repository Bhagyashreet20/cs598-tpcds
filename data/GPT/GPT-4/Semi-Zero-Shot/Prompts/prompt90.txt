With the TPC-DS dataset as a reference, using the table and field names from the TPC-DS benchmark, convert natural language directive provided as input into an SQL query in the Netezza dialect?
Input: The query calculates the ratio between the number of items sold over the internet in the morning (between 10 and 11 AM) and the number of items sold in the evening (between 4 and 5 PM) by customers who have a specified number of dependents. It only considers websites with a significant amount of content, specifically between 5000 and 5200 characters. The results are sorted by the calculated ratio and limited to the top 100 records.