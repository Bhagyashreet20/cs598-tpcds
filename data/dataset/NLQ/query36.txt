Compute the gross profit margin of store sales, and rank items based on their performance in a given year, specifically in 2002. The data considered for this analysis comes from store sales, date dimension, item, and store tables. It focuses on specific states, including 'SD,' 'TN,' 'GA,' 'SC,' 'MO,' 'AL,' 'MI,' and 'OH.' The results are grouped by product category and class, with additional grouping indicators. The final result is ordered by the hierarchy of categories and classes in descending order. In cases where there's no hierarchy, the ranking is done based on the product category. The limit for the results is set to 100.