Binder Error: No function matches the given name and argument types 'date_sub(VARCHAR, INTERVAL)'. You might need to add explicit type casts.
	Candidate functions:
	date_sub(VARCHAR, DATE, DATE) -> BIGINT
	date_sub(VARCHAR, TIMESTAMP, TIMESTAMP) -> BIGINT
	date_sub(VARCHAR, TIME, TIME) -> BIGINT
	date_sub(VARCHAR, TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE) -> BIGINT

LINE 4:     (SUM(CASE WHEN d....
                                       ^