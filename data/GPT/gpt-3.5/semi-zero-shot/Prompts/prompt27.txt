With the TPC-DS dataset as a reference, using the table and field names from the TPC-DS benchmark, convert natural language directive provided as input into an SQL query in the Netezza dialect?
Input: For all items sold in stores located in the states of Missouri (MO), Alabama (AL), Michigan (MI), Tennessee (TN), Louisiana (LA), and South Carolina (SC) during the year 1999, we calculate the average quantity, average list price, average sales price, and average coupon amount for female customers who are married (marital status 'D') and have a secondary education. The results are grouped by item ID and state, with an additional rollup summary. The final results are ordered by item ID and state, and limited to the first 100 records.