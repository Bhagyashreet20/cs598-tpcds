With the TPC-DS dataset as a reference, using the table and field names from the TPC-DS benchmark, convert natural language directive provided as input into an SQL query in the Netezza dialect?
Input: Computed the impact of an item price change on sales by analyzing the total sales for items in a 30-day period both before and after the price adjustment. The items are grouped based on the location of the warehouse from which they were delivered. Additionally, the results are ordered by the state of the warehouse and the item ID, and the analysis is limited to the top 100 results.