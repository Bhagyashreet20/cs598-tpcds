With the TPC-DS dataset as a reference, using the table and field names from the TPC-DS benchmark, convert natural language directive provided as input into an SQL query in the Netezza dialect?
Input: Roll up the web sales data for the year 1224 by category and class. Then, within each group, calculate the total sum of net paid sales and determine the location within the hierarchy. Additionally, rank the sales within the group. The results are ordered in descending order by the location hierarchy and by the category if the hierarchy is at level 0. Finally, limit the results to the top 100 records.