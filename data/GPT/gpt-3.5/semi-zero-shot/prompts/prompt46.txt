With the TPC-DS dataset as a reference, using the table and field names from the TPC-DS benchmark, convert natural language directive provided as input into an SQL query in the Netezza dialect?
Input: Calculate the total coupon amount and net profit for customers who reside out of town and made purchases in stores located in five specific cities on weekends over a span of three consecutive years. These customers should have a specified number of dependents and no vehicles. For each of these customers, provide the city they resided in at the time of purchase, the city where the store is situated, the coupon amount, and net profit. Sort the results by the customers' last names, first names, the city where they currently live, the city where they made the purchase, and the ticket number. Limit the output to the top 100 records.